<!DOCTYPE html>
<html>
<head>
    <title>@ViewBag.Title</title>
    <link href="@Url.Content("~/Content/themes/base/jquery.ui.all.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/Site.css")" rel="stylesheet" type="text/css" />
    <script src="@Url.Content("~/Scripts/jquery-1.5.1.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery-ui-1.8.11.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.ui.datepicker-hr.js")" type="text/javascript"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--DatePicker-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.4/css/bootstrap-datepicker.css" type="text/css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.4/js/bootstrap-datepicker.js" type="text/javascript"></script>

</head>

@if (false)
{
    // da proradi Intellisense za jquery
    <script src="../../Scripts/jquery-1.5.1-vsdoc.js" type="text/javascript"></script>
}

<body class="container-fluid">

    <script>
  //prefix za linkove koji se ne mogu automatski generirati
  var appRoot = '@Url.Content("~/")';
    </script>
    <header id="header">
        <nav id="navbar" class="navbar bg-primary justify-content-start">
            <span>
                <button id="toggleSidebar" class="btn btn-primary" type="button" target="#sidebar">
                    <i class="large material-icons">view_headline</i>
                </button>
            </span>


            <span class="navbar-text text-white ml-5">
                <h1>Autoservis</h1>
            </span>

            <div class="ml-auto">
                <button class="collapsor rounded mr-3 btn btn-primary" target="#userData" min-width="800">
                    <i class="large material-icons">account_circle</i>
                </button>
            </div>

            <div class="text-white  mr-3 bg-light p-2 rounded" id="userData">
                @Html.Partial("_LoginPartial")
            </div>

        </nav>
    </header>

    <div class="row h-100 container-fluid" id="underHeaderContent">

        <nav id="sidebar" class="navbar bg-dark">
            <ul class="navbar-nav ">
               
                @if (!Request.IsAuthenticated)
                {
                    @Html.Partial("_UnregisteredUserSidebar")
                }
                else
                {
                    if (User.IsInRole("Admin"))
                    {
                        @Html.Partial("_AdminSidebar")
                    }
                else
                    {
                        @Html.Partial("_RegisteredUserSidebar")
                    }
                }
            </ul>
        </nav>

        <main id="main">

            <div id="content">
                @RenderBody()
            </div>

        </main>
    </div>

    @if (TempData["Pogreska"] != null)
    {
        <div class="error">@TempData["Pogreska"]</div>
    }



    <script language="javascript" type="text/javascript">
        $(function () { // izvršava se nakon učitavanja dokumenta

            // oboji klasu pogleda "tablica"
            $('.tablica tr:even').addClass('zebra');

            // svim objektima koji imaju css klasu delete
            // umetni kod koji se obavi na click
            $('.delete').each(function () {
                $(this).click(function () {
                    if (confirm("Obrisati zapis?")) {
                        $(this).closest('form').submit();
                    }
                }
                );
            }
            );
            // analogno za submit
            $('.submit').each(function () {
                $(this).click(function () {
                    $(this).closest('form').submit();
                });
            });

            adjustHeaderAndContent();
        }

        );
        window.onresize = () => adjustHeaderAndContent();

        function adjustHeaderAndContent() {
            const navHeight = $("#navbar").innerHeight();
            $("#header").height(navHeight);
            $("#underHeaderContent").css("margin-top", navHeight);
            $("#sidebar").height(window.innerHeight - navHeight);
            
        }
    </script>
    <script>
        
        $('#toggleSidebar').on('click', () => {
            console.log("klik")
            let target = $('#toggleSidebar').attr("target");

            console.log(`${target}`)
            if ($(target).hasClass('show')) {
                $(target).removeClass('show');
            }
            else {
                $(target).addClass('show');
            }

        })

        /* let q = window.matchMedia(("min-width:800px"));
         console.log(q)
         if (q.matches)  {
             alert("media");
         }*/

        $(function () {
            $(window).on('resize', function () {
                if (window.innerWidth > 800) {
                    console.log("prepoznato")
                    $('#sidebar').removeClass('show');

                }
                $(window).on('click', (event) => {

                })
            });
        });

    </script>

    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")
    @Scripts.Render("~/Scripts/layoutExtension.js")
    @RenderSection("JavaScript", required: false)
    @RenderSection("scripts", required: false)
</body>
</html>